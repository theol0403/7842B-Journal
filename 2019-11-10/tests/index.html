<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="IE=Edge" /> <meta name="theme-color" content="#94ddff" /> <meta http-equiv="cache-control" content="no-cache" /> <meta http-equiv="expires" content="0" /> <meta http-equiv="pragma" content="no-cache" /> <title>Unit Tests - 7842B Journal</title> <link rel="shortcut icon" href="https://theol0403.github.io/7842B-Journal/assets/images/favicon.ico" type="image/x-icon" /> <link rel="stylesheet" href="https://theol0403.github.io/7842B-Journal/assets/css/just-the-docs.css" /> <script type="text/javascript" src="https://theol0403.github.io/7842B-Journal/assets/js/vendor/lunr.min.js" ></script> <script type="text/javascript" src="https://theol0403.github.io/7842B-Journal/assets/js/just-the-docs.js" ></script> <meta name="viewport" content="width=device-width, initial-scale=1" /> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Unit Tests | 7842B Journal</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Unit Tests" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="lib7842 is a library that will be released to many teams around the world. In order to make it as bug-free and reliable as possible, all classes have tests written for them. These tests check to make sure all the code is working as expected, and that there are no crashes or bugs." /> <meta property="og:description" content="lib7842 is a library that will be released to many teams around the world. In order to make it as bug-free and reliable as possible, all classes have tests written for them. These tests check to make sure all the code is working as expected, and that there are no crashes or bugs." /> <link rel="canonical" href="https://theol0403.github.io/7842B-Journal/2019-11-10/tests/" /> <meta property="og:url" content="https://theol0403.github.io/7842B-Journal/2019-11-10/tests/" /> <meta property="og:site_name" content="7842B Journal" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2019-11-10T00:00:00+00:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Unit Tests" /> <script type="application/ld+json"> {"@type":"BlogPosting","description":"lib7842 is a library that will be released to many teams around the world. In order to make it as bug-free and reliable as possible, all classes have tests written for them. These tests check to make sure all the code is working as expected, and that there are no crashes or bugs.","mainEntityOfPage":{"@type":"WebPage","@id":"https://theol0403.github.io/7842B-Journal/2019-11-10/tests/"},"url":"https://theol0403.github.io/7842B-Journal/2019-11-10/tests/","headline":"Unit Tests","dateModified":"2019-11-10T00:00:00+00:00","datePublished":"2019-11-10T00:00:00+00:00","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="https://theol0403.github.io/7842B-Journal" class="site-title lh-tight"><span class="bteam">7842B</span>&nbsp;Journal </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item active"><a href="https://theol0403.github.io/7842B-Journal/404.html" class="navigation-list-link"></a></li><li class="navigation-list-item"><a href="https://theol0403.github.io/7842B-Journal/" class="navigation-list-link">Home</a><ul class="navigation-list-child-list "></ul></li><li class="navigation-list-item"><a href="https://theol0403.github.io/7842B-Journal/programming" class="navigation-list-link">Programming</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://theol0403.github.io/7842B-Journal/programming/skills" class="navigation-list-link">Skills</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://theol0403.github.io/7842B-Journal/2021-02-04/v1-skills/" class="navigation-list-link">V1 Skills</a> </li><li class="navigation-list-item "> <a href="https://theol0403.github.io/7842B-Journal/2021-03-01/v2-skills/" class="navigation-list-link">V2 Skills</a> </li><li class="navigation-list-item "> <a href="https://theol0403.github.io/7842B-Journal/2021-04-03/v3-skills/" class="navigation-list-link">V3 Skills</a> </li></ul></li><li class="navigation-list-item "><a href="https://theol0403.github.io/7842B-Journal/programming/intake" class="navigation-list-link">Intake Automation</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://theol0403.github.io/7842B-Journal/2021-03-24/intake-log-2/" class="navigation-list-link">Intake Log 2</a> </li><li class="navigation-list-item "> <a href="https://theol0403.github.io/7842B-Journal/2021-02-20/intake-log-1/" class="navigation-list-link">Intake Log 1</a> </li></ul></li></ul></li><li class="navigation-list-item"><a href="https://theol0403.github.io/7842B-Journal/build" class="navigation-list-link">Build</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://theol0403.github.io/7842B-Journal/build/v1/" class="navigation-list-link">Robot V1</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://theol0403.github.io/7842B-Journal/2021-01-20/intakes/" class="navigation-list-link">Intake Design</a> </li><li class="navigation-list-item "> <a href="https://theol0403.github.io/7842B-Journal/2021-01-15/chassis/" class="navigation-list-link">Robot Chassis</a> </li></ul></li><li class="navigation-list-item "><a href="https://theol0403.github.io/7842B-Journal/build/v2/" class="navigation-list-link">Robot V2</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://theol0403.github.io/7842B-Journal/2021-02-26/upgrades/" class="navigation-list-link">Upgrades</a> </li><li class="navigation-list-item "> <a href="https://theol0403.github.io/7842B-Journal/2021-02-23/deflector/" class="navigation-list-link">Deflector</a> </li></ul></li><li class="navigation-list-item "><a href="https://theol0403.github.io/7842B-Journal/build/v3/" class="navigation-list-link">Robot V3</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://theol0403.github.io/7842B-Journal/2021-04-02/hood-catapult/" class="navigation-list-link">Hood Catapult</a> </li><li class="navigation-list-item "> <a href="https://theol0403.github.io/7842B-Journal/2021-03-29/intake-changes/" class="navigation-list-link">Intake changes</a> </li><li class="navigation-list-item "> <a href="https://theol0403.github.io/7842B-Journal/2021-03-26/roller-changes/" class="navigation-list-link">Roller changes</a> </li></ul></li></ul></li><li class="navigation-list-item active"><a href="https://theol0403.github.io/7842B-Journal/archive" class="navigation-list-link">Archive</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://theol0403.github.io/7842B-Journal/2019-11-28/lib7842/" class="navigation-list-link">lib7842</a></li><li class="navigation-list-item "><a href="https://theol0403.github.io/7842B-Journal/2019-11-25/pure-pursuit/" class="navigation-list-link">Pure Pursuit</a></li><li class="navigation-list-item "><a href="https://theol0403.github.io/7842B-Journal/2019-11-20/odom-x-controller/" class="navigation-list-link">Odom X Controller</a></li><li class="navigation-list-item "><a href="https://theol0403.github.io/7842B-Journal/2019-11-15/odom-controller/" class="navigation-list-link">Odom Controller</a></li><li class="navigation-list-item active"><a href="https://theol0403.github.io/7842B-Journal/2019-11-10/tests/" class="navigation-list-link active">Unit Tests</a></li><li class="navigation-list-item "><a href="https://theol0403.github.io/7842B-Journal/2019-10-19/gui/" class="navigation-list-link">GUI</a></li><li class="navigation-list-item "><a href="https://theol0403.github.io/7842B-Journal/2019-10-18/task-wrapper/" class="navigation-list-link">Task Wrapper</a></li><li class="navigation-list-item "><a href="https://theol0403.github.io/7842B-Journal/2019-10-16/statemachine/" class="navigation-list-link">State Machine</a></li><li class="navigation-list-item "><a href="https://theol0403.github.io/7842B-Journal/2019-10-15/motion-algorithms/" class="navigation-list-link">Motion Algorithms</a></li><li class="navigation-list-item "><a href="https://theol0403.github.io/7842B-Journal/2019-08-19/robot-showcase/" class="navigation-list-link">2018-19 Showcase</a></li></ul></li></ul> </nav> </div> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search 7842B Journal" aria-label="Search 7842B Journal" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> <ul class="list-style-none text-small aux-nav"> <li class="d-inline-block my-0 mr-2"><a href="https://theol0403.github.io/7842B-Journal/build">Build</a></li> <li class="d-inline-block my-0"><a href="https://theol0403.github.io/7842B-Journal/programming">Programming</a></li> </ul> </div> <div class="page"> <nav class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://theol0403.github.io/7842B-Journal/archive">Archive</a></li> <li class="breadcrumb-nav-list-item"><span>Unit Tests</span></li> </ol> </nav> <div id="main-content" class="page-content" role="main"> <h1> <a href="https://theol0403.github.io/7842B-Journal/2019-11-10/tests/"> Unit Tests </a> - November 10, 2019 </h1> <article><p>lib7842 is a library that will be released to many teams around the world. In order to make it as bug-free and reliable as possible, all classes have tests written for them. These tests check to make sure all the code is working as expected, and that there are no crashes or bugs.</p> <p>Tests are run by Azure Pipelines CI. Every commit I make on GitHub gets processed and tested in the cloud, with the results reported back to me. The automated process also runs static analysis via CppCheck, which can find bugs in my code. Finally I run valgrind and callgrind, a memory leak and profiler tool.</p> <p><img src="images/image-20200228221927157.png" alt="" /></p> <h2 id="tests"> <a href="#tests" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Tests </h2> <p>I use a testing framework called <a href="https://github.com/onqtam/doctest">doctest</a>. It allows me to write expressive tests through the TDD (Test Driven Development) workflow.</p> <p>Here is an example test:</p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">GIVEN</span><span class="p">(</span><span class="s">"a data point with some data"</span><span class="p">)</span> <span class="p">{</span>
<span class="n">DataPoint</span> <span class="n">point1</span> <span class="p">{</span><span class="mi">5</span><span class="n">_in</span><span class="p">,</span> <span class="mi">3</span><span class="n">_in</span><span class="p">};</span>

<span class="n">point1</span><span class="p">.</span><span class="n">setData</span><span class="p">(</span><span class="s">"curvature"</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">);</span>
<span class="n">point1</span><span class="p">.</span><span class="n">setData</span><span class="p">(</span><span class="s">"distance"</span><span class="p">,</span> <span class="mi">5</span><span class="n">_m</span><span class="p">);</span>
<span class="n">point1</span><span class="p">.</span><span class="n">setData</span><span class="p">(</span><span class="s">"velocity"</span><span class="p">,</span> <span class="mi">5</span><span class="n">_mps</span><span class="p">);</span>
<span class="n">point1</span><span class="p">.</span><span class="n">setData</span><span class="p">(</span><span class="s">"segmentIndex"</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>

<span class="n">THEN</span><span class="p">(</span><span class="s">"constructors should work"</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">DataPath</span><span class="p">();</span>
  <span class="n">DataPath</span><span class="p">({</span><span class="n">point1</span><span class="p">});</span>
  <span class="n">DataPath</span><span class="p">({</span><span class="n">point1</span><span class="p">,</span> <span class="n">point1</span><span class="p">});</span>
  <span class="n">DataPath</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">DataPoint</span><span class="o">&gt;</span><span class="p">({</span><span class="n">point1</span><span class="p">,</span> <span class="n">point1</span><span class="p">}));</span>
<span class="p">}</span>

<span class="n">GIVEN</span><span class="p">(</span><span class="s">"a path containing three points"</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">DataPath</span> <span class="n">path</span><span class="p">({</span><span class="n">point1</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="n">point1</span><span class="p">});</span>

  <span class="n">THEN</span><span class="p">(</span><span class="s">"the size of the path should be three"</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">path</span><span class="p">().</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">3</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">THEN</span><span class="p">(</span><span class="s">"each point should contain data"</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">&amp;&amp;</span> <span class="n">point</span> <span class="o">:</span> <span class="n">path</span><span class="p">())</span> <span class="p">{</span>
      <span class="n">CHECK</span><span class="p">(</span><span class="n">point</span><span class="o">-&gt;</span><span class="n">getData</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"curvature"</span><span class="p">)</span> <span class="o">==</span> <span class="mf">5.0</span><span class="p">);</span>
      <span class="n">CHECK</span><span class="p">(</span><span class="n">point</span><span class="o">-&gt;</span><span class="n">getData</span><span class="o">&lt;</span><span class="n">QLength</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"distance"</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="n">_m</span><span class="p">);</span>
      <span class="n">CHECK</span><span class="p">(</span><span class="n">point</span><span class="o">-&gt;</span><span class="n">getData</span><span class="o">&lt;</span><span class="n">QSpeed</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"velocity"</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="n">_mps</span><span class="p">);</span>
      <span class="n">CHECK</span><span class="p">(</span><span class="n">point</span><span class="o">-&gt;</span><span class="n">getData</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"segmentIndex"</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">GIVEN</span><span class="p">(</span><span class="s">"a simple path generated from the data path"</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">SimplePath</span> <span class="n">ipath</span> <span class="o">=</span> <span class="n">path</span><span class="p">.</span><span class="n">generate</span><span class="p">();</span>

    <span class="n">THEN</span><span class="p">(</span><span class="s">"the size of the path should be three"</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">REQUIRE</span><span class="p">(</span><span class="n">ipath</span><span class="p">().</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">3</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">THEN</span><span class="p">(</span><span class="s">"the positions should be the same"</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">&amp;&amp;</span> <span class="n">point</span> <span class="o">:</span> <span class="n">ipath</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">CHECK</span><span class="p">(</span><span class="o">*</span><span class="n">point</span> <span class="o">==</span> <span class="n">point1</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>If any of the tests fail, I will be notified and I will be able to solve the problem. Tests have already found many bugs I would have missed, and is a great way to test code without needing a robot.</p> <p><img src="images/image-20200228222854511.png" alt="" /></p> </article> <hr> <footer role="contentinfo"> <p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2020-2021</p> </footer> </div> </div> </div> </div> </body> </html>
